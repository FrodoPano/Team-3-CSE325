@page "/register"
@rendermode InteractiveServer

@inject NavigationManager Nav

<h1>Register</h1>
<p>Create a new account.</p>

@if (ErrorMessage is not null)
{
    <p style="color:#b00020; font-weight:600;">‚ùå @ErrorMessage</p>
}

<form method="post" action="/account/register" style="max-width:420px;">
    <AntiforgeryToken />

    <div style="margin-bottom:12px;">
        <label>Email</label><br />
        <input name="email" class="form-control" />
    </div>

    <div style="margin-bottom:12px;">
        <label>Password</label><br />
        <input name="password" type="password" class="form-control" />
    </div>

    <div style="margin-bottom:12px;">
        <label>Confirm Password</label><br />
        <input name="confirmPassword" type="password" class="form-control" />
    </div>

    <button type="submit">Create account</button>
</form>

@code {
    private string? ErrorMessage
    {
        get
        {
            var q = Nav.ToAbsoluteUri(Nav.Uri).Query;
            if (q.Contains("error=pwdmatch")) return "Passwords do not match.";
            if (q.Contains("error=1")) return "Could not create the user (email may already exist or password rules).";
            return null;
        }
    }
}
